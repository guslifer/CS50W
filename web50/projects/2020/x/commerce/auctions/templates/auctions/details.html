{% extends 'auctions/layout.html' %}
{%load static %}


{%block body%}
{% if message %}
<h1>{{message}}</h1>
{%endif%}
<div class = "container">
    <div class="row justify-content-center mt-5 mb-3" style="text-align:center">
      <div class= "col-2 justify-content-end">
        <h5> Details </h5>
      </div>
      <div class= "col-2 justify-content-start">
        <form action="{% url "auctions:details" listing.id %}" method="post">
          {% csrf_token %}
          {% if user.is_authenticated and user != listing.author %}
            {%if rm_watchlist%}
              <button class="btn btn-danger" name="watchlist" value="True" type="submit">Remove from Watchlist</button>
            {%else%}
              <button class="btn btn-success" name="watchlist" value="True" type="submit">Add to Watchlist</button>
            {%endif%}
          {%endif%}
        </form>
      </div>
    </div>
      <div class = "row justify-content-center ">
          <div class="col-4 mt-3">
                <div class="mb-1 mt-2">
                  <img src="{{listing.image_url}}" class="img-thumbnail rounded mx-auto d-block" alt="..." >
                </div>
                {% if user.is_authenticated and user == listing.author %}
                <form  action="{% url "auctions:details" listing.id %}" method="POST">
                  {% csrf_token %}
                  <div class = "row justify-content-center mt-3 ">
                    <div class = "col text-center ">
                      <button class="btn btn-success" name="close_auction" value="True" type="submit">Close Auction</button>
                    </div>
                  </div>
                </form>
                {% elif user.is_authenticated %}
                    <form action="{% url "auctions:details" listing.id %}" method="POST">
                      {% csrf_token %}
                        <div class = "row justify-content-center mt-3 ">
                              <div class = "col-8">
                                  <label for = "new_bid"> Bid Value</label>
                                  <input class="form-control"  min="0.01" step="0.01" name= "new_bid" id = "new_bid" type="number" placeholder="U$ 0.00" aria-label="default input example" value = {{listing.product_name}} required>
                              </div>
                              <div class="col-4 mt-3 mb-3">
                                  <button class="btn btn-light " type="submit" value = "True" name="make_bid">Make a Bid</button>
                              </div>
                        </div>
                    </form>
                {%endif%}
          </div>
          <div class = "col-8 mt-3">
            <form action="{% url 'auctions:newlisting' %}" method="post">
              <fieldset disabled>
                <div class="mb-1">
                  <label for = "product_name"> Product's name</label>
                  <input class="form-control" name= "product_name" id = "product_name" type="text" placeholder="Name" aria-label="default input example" value = {{listing.product_name}} required>
                </div>

                <div class="mb-1">
                  <label for = "description"> Description </label>
                  <textarea class="form-control" name="description" id="description" rows="7" required>{{listing.description}}</textarea>  
                </div>

                <div class="mb-1">
                  <label for = "category"> Category </label>
                  <input class="form-control" name= "product_name" id = "category" type="text" placeholder="category" aria-label="default input example" value = {{listing.category}} required>
                </div>

                <div class="mb-1">
                  <label for = "publish_date"> Publish Date </label>
                  <input class="form-control" name= "product_name" id = "publish_date" type="text" placeholder="-" aria-label="default input example" value = "{{listing.publish_date|date:"D d M Y" }} {{listing.publish_date|time:"H:i" }}" required>
                </div>

                <div class="mb-1">
                  <label for = "author"> Author</label>
                  <input class="form-control" name= "author" id = "author" type="text" placeholder="-" aria-label="default input example" value = {{listing.author}} required>
                </div>

                <div class="mb-5">
                  <label for = "highest_bid"> Highest Bid </label>
                  <input class="form-control" name= "highest_bid" id = "highest_bid" type="text" placeholder="-" aria-label="default input example" value = {{actual_price}} required>
                </div>
              </fieldset>
            </form>
          </div>
        </div>    
</div>
{%endblock%}